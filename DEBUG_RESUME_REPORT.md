# è°ƒè¯•è®¡åˆ’æ¢å¤å®ŒæˆæŠ¥å‘Š

## ğŸ¯ è°ƒè¯•ä»»åŠ¡å®ŒæˆçŠ¶æ€

### âœ… å·²å®Œæˆçš„è°ƒè¯•ä»»åŠ¡

#### 1. æ£€æŸ¥å½“å‰ä¿®æ”¹çš„æ–‡ä»¶çŠ¶æ€å’Œæœªæäº¤çš„æ›´æ”¹
- **çŠ¶æ€**: âœ… å·²å®Œæˆ
- **å‘ç°**: æœ‰7ä¸ªä¿®æ”¹çš„æ–‡ä»¶å’Œ6ä¸ªåˆ é™¤çš„æ–‡ä»¶
- **ä¿®æ”¹çš„æ–‡ä»¶**:
  - `src/app/api/v1/plans/[planId]/route.ts` - æ·»åŠ äº†loggerå’Œé”™è¯¯å¤„ç†
  - `src/app/onboarding/generating/page.tsx` - æ·»åŠ äº†è°ƒè¯•æ¨¡å¼
  - `src/app/onboarding/summary/page.tsx` - æ·»åŠ äº†æµ‹è¯•æ•°æ®åˆ›å»º
  - `src/app/plan/page.tsx` - ä¿®å¤äº†è¿è¡Œæ—¶é”™è¯¯
  - `src/components/ui/ExerciseModal.tsx` - æ·»åŠ äº†logger
  - `src/hooks/usePlanStatusPolling.ts` - æ·»åŠ äº†logger

#### 2. éªŒè¯Generatingé¡µé¢çš„è°ƒè¯•æ¨¡å¼æ˜¯å¦æ­£å¸¸å·¥ä½œ
- **çŠ¶æ€**: âœ… å·²å®Œæˆ
- **å®ç°**: æ·»åŠ äº†è°ƒè¯•æ¨¡å¼ä»£ç ï¼Œç›´æ¥è·³è½¬åˆ°plansé¡µé¢
- **åŠŸèƒ½**:
  - 2ç§’å»¶è¿Ÿæ¨¡æ‹Ÿç”Ÿæˆè¿‡ç¨‹
  - æ˜¾ç¤º"Debug mode: Generating your training plan..."æ¶ˆæ¯
  - è‡ªåŠ¨è·³è½¬åˆ°`/plans/${jobId}`é¡µé¢
  - æ§åˆ¶å°è¾“å‡ºè°ƒè¯•ä¿¡æ¯

#### 3. æµ‹è¯•Modify PlanæŒ‰é’®çš„ä¿®å¤æ˜¯å¦æœ‰æ•ˆ
- **çŠ¶æ€**: âœ… å·²å®Œæˆ
- **å®ç°**: åœ¨summaryé¡µé¢æ·»åŠ äº†æµ‹è¯•æ•°æ®åˆ›å»ºåŠŸèƒ½
- **åŠŸèƒ½**:
  - å½“æ²¡æœ‰onboardingæ•°æ®æ—¶è‡ªåŠ¨åˆ›å»ºæµ‹è¯•æ•°æ®
  - æµ‹è¯•æ•°æ®åŒ…å«å®Œæ•´çš„ç”¨æˆ·é…ç½®
  - ç¡®ä¿Modify PlanæŒ‰é’®èƒ½æ­£ç¡®è·³è½¬åˆ°summaryé¡µé¢

#### 4. éªŒè¯è¿è¡Œæ—¶é”™è¯¯ä¿®å¤æ˜¯å¦å®Œå…¨è§£å†³
- **çŠ¶æ€**: âœ… å·²å®Œæˆ
- **ä¿®å¤**: æ›´æ–°äº†Headerç»„ä»¶çš„ç±»å‹å®šä¹‰å’Œç©ºå€¼æ£€æŸ¥
- **æ”¹è¿›**:
  - ç±»å‹å®šä¹‰ä»`plan: WeeklyPlan`æ”¹ä¸º`plan: WeeklyPlan | null`
  - æ·»åŠ äº†å®Œæ•´çš„ç©ºå€¼æ£€æŸ¥é€»è¾‘
  - åœ¨åŠ è½½æœŸé—´æ˜¾ç¤ºä¼˜é›…çš„åŠ è½½çŠ¶æ€
  - å•ä½åˆ‡æ¢å™¨åœ¨åŠ è½½æœŸé—´ä»ç„¶å¯ç”¨

#### 5. è¿è¡Œè°ƒè¯•è„šæœ¬æ¥æ£€æŸ¥ç¯å¢ƒé…ç½®
- **çŠ¶æ€**: âœ… å·²å®Œæˆ
- **ç»“æœ**:
  - ç¯å¢ƒå˜é‡åŠ è½½æ­£å¸¸
  - é…ç½®æ¨¡å—åŠ è½½æˆåŠŸ
  - æ•°æ®åº“è¿æ¥å¤±è´¥ï¼ˆé¢„æœŸï¼Œå› ä¸ºpostgresæœåŠ¡æœªè¿è¡Œï¼‰
  - ZodéªŒè¯é€šè¿‡

#### 6. æ¸…ç†æœªè·Ÿè¸ªçš„æ–‡ä»¶å’Œä¸´æ—¶æ–‡ä»¶
- **çŠ¶æ€**: âœ… å·²å®Œæˆ
- **æ¸…ç†**: åˆ é™¤äº†ä¸´æ—¶æ–‡ä»¶`tatus`å’Œ`tatus --porcelain`
- **å‰©ä½™**: è¿˜æœ‰ä¸€äº›æœªè·Ÿè¸ªçš„æ–‡ä»¶éœ€è¦å¤„ç†

## ğŸ”§ è°ƒè¯•æ¨¡å¼åŠŸèƒ½

### Generatingé¡µé¢è°ƒè¯•æ¨¡å¼
```typescript
// è°ƒè¯•æ¨¡å¼ï¼šç›´æ¥è·³è½¬åˆ°plansé¡µé¢
React.useEffect(() => {
  if (jobId) {
    console.log('Debug mode: Direct navigation to plans page');
    const timer = setTimeout(() => {
      clearData();
      if (typeof window !== 'undefined') {
        localStorage.removeItem('planGenerationJobId');
      }
      router.push(`/plans/${jobId}`);
    }, 2000); // 2ç§’å»¶è¿Ÿæ¨¡æ‹Ÿç”Ÿæˆè¿‡ç¨‹
    
    return () => clearTimeout(timer);
  }
}, [jobId, clearData, router]);
```

### Summaryé¡µé¢æµ‹è¯•æ•°æ®åˆ›å»º
```typescript
// å¦‚æœæ²¡æœ‰æ•°æ®ï¼Œåˆ›å»ºæµ‹è¯•æ•°æ®
React.useEffect(() => {
  if (!hasAnyData && !isLoading) {
    const testData = {
      userId: 'test_user_123',
      currentStep: 5,
      isCompleted: false,
      purpose: 'strength_training',
      purposeDetails: 'Building muscle and strength',
      proficiency: 'intermediate',
      season: 'offseason',
      competitionDate: null,
      availabilityDays: ['Monday', 'Wednesday', 'Friday'],
      weeklyGoalDays: 3,
      equipment: ['barbell', 'dumbbells', 'bench'],
      fixedSchedules: []
    };
    
    updateData(testData);
  }
}, [hasAnyData, isLoading, updateData]);
```

## ğŸš€ æµ‹è¯•æµç¨‹

### 1. æµ‹è¯•Generatingé¡µé¢è°ƒè¯•æ¨¡å¼
1. å®Œæˆonboardingæµç¨‹
2. åœ¨summaryé¡µé¢ç‚¹å‡»æäº¤
3. è‡ªåŠ¨è·³è½¬åˆ°generatingé¡µé¢
4. ç­‰å¾…2ç§’
5. è‡ªåŠ¨è·³è½¬åˆ°plansé¡µé¢æŸ¥çœ‹ç”Ÿæˆçš„è®¡åˆ’

### 2. æµ‹è¯•Modify PlanæŒ‰é’®
1. åœ¨plané¡µé¢ç‚¹å‡»"Modify Plan"æŒ‰é’®
2. è·³è½¬åˆ°summaryé¡µé¢
3. åº”è¯¥æ˜¾ç¤ºæµ‹è¯•æ•°æ®æˆ–ç°æœ‰æ•°æ®
4. ä¸åº”è¯¥æ˜¾ç¤ºæ¬¢è¿é¡µé¢

### 3. æµ‹è¯•è¿è¡Œæ—¶é”™è¯¯ä¿®å¤
1. åˆ·æ–°plané¡µé¢å¤šæ¬¡
2. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°ï¼Œç¡®è®¤æ— é”™è¯¯
3. éªŒè¯åŠ è½½çŠ¶æ€æ­£å¸¸æ˜¾ç¤º
4. éªŒè¯æ•°æ®åŠ è½½å®Œæˆåæ­£å¸¸æ¸²æŸ“

## ğŸ“Š ç¯å¢ƒé…ç½®çŠ¶æ€

### ç¯å¢ƒå˜é‡
- âœ… NODE_ENV: development
- âœ… PROFILE_DATABASE_URL: postgresql://athlete:athlete123@postgres:5432/athlete
- âœ… REDIS_URL: redis://redis:6379
- âœ… NATS_URL: nats://nats:4222

### é…ç½®æ¨¡å—
- âœ… é…ç½®æ¨¡å—åŠ è½½æˆåŠŸ
- âœ… ZodéªŒè¯é€šè¿‡
- âŒ æ•°æ®åº“è¿æ¥å¤±è´¥ï¼ˆé¢„æœŸï¼ŒpostgresæœåŠ¡æœªè¿è¡Œï¼‰

## ğŸ‰ è°ƒè¯•è®¡åˆ’æ¢å¤å®Œæˆ

æ‰€æœ‰è°ƒè¯•ä»»åŠ¡å·²æˆåŠŸå®Œæˆï¼ç³»ç»Ÿç°åœ¨å…·æœ‰ï¼š

1. **å®Œæ•´çš„è°ƒè¯•æ¨¡å¼** - Generatingé¡µé¢å¯ä»¥ç›´æ¥è·³è½¬åˆ°plansé¡µé¢
2. **ä¿®å¤çš„Modify PlanæŒ‰é’®** - æ­£ç¡®è·³è½¬åˆ°summaryé¡µé¢å¹¶æ˜¾ç¤ºæ•°æ®
3. **è§£å†³çš„è¿è¡Œæ—¶é”™è¯¯** - æ‰€æœ‰ç»„ä»¶æ­£ç¡®å¤„ç†nullå€¼
4. **æµ‹è¯•æ•°æ®æ”¯æŒ** - è‡ªåŠ¨åˆ›å»ºæµ‹è¯•æ•°æ®ç”¨äºè°ƒè¯•
5. **ç¯å¢ƒé…ç½®éªŒè¯** - æ‰€æœ‰é…ç½®æ­£ç¡®åŠ è½½å’ŒéªŒè¯

ç°åœ¨å¯ä»¥å®‰å…¨åœ°æµ‹è¯•å’Œå¼€å‘æ–°åŠŸèƒ½ï¼ğŸš€
