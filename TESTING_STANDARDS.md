# ğŸ§ª æµ‹è¯•é…ç½®æ ‡å‡† - ç»Ÿä¸€æµ‹è¯•è§„èŒƒ

## æµ‹è¯•æ–‡ä»¶å‘½åå’Œå®šä½è§„èŒƒ

### æ–‡ä»¶å‘½åè§„èŒƒ
- **æ‰€æœ‰æµ‹è¯•æ–‡ä»¶å¿…é¡»ä»¥ `.test.ts` ç»“å°¾**
- **é›†æˆæµ‹è¯•æ–‡ä»¶å¿…é¡»ä»¥ `.integration.test.ts` ç»“å°¾**
- **ç«¯åˆ°ç«¯æµ‹è¯•æ–‡ä»¶å¿…é¡»ä»¥ `.e2e.test.ts` ç»“å°¾**

### ç›®å½•ç»“æ„è§„èŒƒ
```
src/
â”œâ”€â”€ __tests__/           # å•å…ƒæµ‹è¯•ç›®å½•
â”‚   â”œâ”€â”€ unit/            # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ integration/     # é›†æˆæµ‹è¯•
â”‚   â””â”€â”€ e2e/            # ç«¯åˆ°ç«¯æµ‹è¯•
â”œâ”€â”€ lib/
â”‚   â””â”€â”€ protocols/
â”‚       â””â”€â”€ __tests__/   # åè®®ç›¸å…³æµ‹è¯•
â””â”€â”€ components/
    â””â”€â”€ __tests__/       # ç»„ä»¶æµ‹è¯•

services/
â””â”€â”€ [service-name]/
    â””â”€â”€ src/
        â””â”€â”€ __tests__/   # æœåŠ¡æµ‹è¯•

packages/
â””â”€â”€ [package-name]/
    â””â”€â”€ __tests__/       # åŒ…æµ‹è¯•
```

### æµ‹è¯•æ–‡ä»¶ç¤ºä¾‹
```typescript
// src/__tests__/unit/user-service.test.ts
import { describe, it, expect } from '@jest/globals';
import { UserService } from '../lib/user-service';

describe('UserService', () => {
  it('should create user successfully', () => {
    // æµ‹è¯•é€»è¾‘
  });
});
```

## Jest é…ç½®æ ‡å‡†

### æ ¹ç›®å½•é…ç½® (jest.config.js)
- æ”¯æŒ TypeScript å’Œ JavaScript
- ç»Ÿä¸€çš„æµ‹è¯•æ–‡ä»¶å‘ç°æ¨¡å¼
- æ­£ç¡®çš„è·¯å¾„æ˜ å°„å’Œåˆ«å
- é€‚å½“çš„è¦†ç›–ç‡æ”¶é›†

### æœåŠ¡çº§é…ç½®
- æ¯ä¸ªæœåŠ¡å¯ä»¥æœ‰ç‹¬ç«‹çš„ jest.config.js
- ç»§æ‰¿æ ¹é…ç½®å¹¶è¦†ç›–ç‰¹å®šè®¾ç½®
- æ”¯æŒæœåŠ¡ç‰¹å®šçš„æµ‹è¯•ç¯å¢ƒ

## æµ‹è¯•ç±»å‹åˆ†ç±»

### 1. å•å…ƒæµ‹è¯• (Unit Tests)
- **ä½ç½®**: `src/__tests__/unit/`
- **å‘½å**: `*.test.ts`
- **ç›®çš„**: æµ‹è¯•å•ä¸ªå‡½æ•°ã€ç±»æˆ–æ¨¡å—
- **ç‰¹ç‚¹**: å¿«é€Ÿã€ç‹¬ç«‹ã€æ— å¤–éƒ¨ä¾èµ–

### 2. é›†æˆæµ‹è¯• (Integration Tests)
- **ä½ç½®**: `src/__tests__/integration/`
- **å‘½å**: `*.integration.test.ts`
- **ç›®çš„**: æµ‹è¯•æ¨¡å—é—´çš„äº¤äº’
- **ç‰¹ç‚¹**: æ¶‰åŠæ•°æ®åº“ã€APIç­‰å¤–éƒ¨ä¾èµ–

### 3. ç«¯åˆ°ç«¯æµ‹è¯• (E2E Tests)
- **ä½ç½®**: `src/__tests__/e2e/`
- **å‘½å**: `*.e2e.test.ts`
- **ç›®çš„**: æµ‹è¯•å®Œæ•´çš„ç”¨æˆ·æµç¨‹
- **ç‰¹ç‚¹**: æ¨¡æ‹ŸçœŸå®ç”¨æˆ·æ“ä½œ

## æµ‹è¯•è„šæœ¬æ ‡å‡†

### æ ¹ç›®å½•è„šæœ¬
```json
{
  "scripts": {
    "test": "jest",
    "test:unit": "jest --testPathPattern=__tests__/unit",
    "test:integration": "jest --testPathPattern=__tests__/integration",
    "test:e2e": "jest --testPathPattern=__tests__/e2e",
    "test:watch": "jest --watch",
    "test:coverage": "jest --coverage"
  }
}
```

### æœåŠ¡çº§è„šæœ¬
```json
{
  "scripts": {
    "test": "jest --config=jest.config.js",
    "test:watch": "jest --watch --config=jest.config.js"
  }
}
```

## è¦†ç›–ç‡æ ‡å‡†

### æœ€ä½è¦†ç›–ç‡è¦æ±‚
- **è¯­å¥è¦†ç›–ç‡**: â‰¥ 80%
- **åˆ†æ”¯è¦†ç›–ç‡**: â‰¥ 75%
- **å‡½æ•°è¦†ç›–ç‡**: â‰¥ 80%
- **è¡Œè¦†ç›–ç‡**: â‰¥ 80%

### è¦†ç›–ç‡æ’é™¤
- æµ‹è¯•æ–‡ä»¶æœ¬èº«
- ç±»å‹å®šä¹‰æ–‡ä»¶ (.d.ts)
- é…ç½®æ–‡ä»¶
- æ„å»ºè¾“å‡ºæ–‡ä»¶

## æµ‹è¯•ç¯å¢ƒé…ç½®

### æµ‹è¯•ç¯å¢ƒå˜é‡
```bash
# .env.test
NODE_ENV=test
DATABASE_URL=postgresql://test:test@localhost:5432/test_db
REDIS_URL=redis://localhost:6379/1
```

### æµ‹è¯•æ•°æ®åº“
- ä½¿ç”¨ç‹¬ç«‹çš„æµ‹è¯•æ•°æ®åº“
- æ¯ä¸ªæµ‹è¯•å‰æ¸…ç†æ•°æ®
- ä½¿ç”¨äº‹åŠ¡å›æ»šç¡®ä¿éš”ç¦»

## æœ€ä½³å®è·µ

### 1. æµ‹è¯•ç»„ç»‡
- æŒ‰åŠŸèƒ½æ¨¡å—ç»„ç»‡æµ‹è¯•
- ä½¿ç”¨æè¿°æ€§çš„æµ‹è¯•åç§°
- éµå¾ª AAA æ¨¡å¼ (Arrange, Act, Assert)

### 2. æµ‹è¯•æ•°æ®
- ä½¿ç”¨å·¥å‚å‡½æ•°åˆ›å»ºæµ‹è¯•æ•°æ®
- é¿å…ç¡¬ç¼–ç çš„æµ‹è¯•æ•°æ®
- ä½¿ç”¨ fixtures ç®¡ç†å¤æ‚æ•°æ®

### 3. å¼‚æ­¥æµ‹è¯•
- æ­£ç¡®å¤„ç† Promise å’Œ async/await
- ä½¿ç”¨é€‚å½“çš„è¶…æ—¶è®¾ç½®
- æ¸…ç†å¼‚æ­¥èµ„æº

### 4. æ¨¡æ‹Ÿå’Œå­˜æ ¹
- ä½¿ç”¨ Jest çš„æ¨¡æ‹ŸåŠŸèƒ½
- æ¨¡æ‹Ÿå¤–éƒ¨ä¾èµ–
- é¿å…è¿‡åº¦æ¨¡æ‹Ÿ

## æ‰§è¡Œå’Œç›‘æ§

### æœ¬åœ°å¼€å‘
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm run test

# è¿è¡Œç‰¹å®šç±»å‹æµ‹è¯•
npm run test:unit
npm run test:integration
npm run test:e2e

# ç›‘è§†æ¨¡å¼
npm run test:watch
```

### CI/CD é›†æˆ
- æ‰€æœ‰æµ‹è¯•å¿…é¡»åœ¨ CI ä¸­é€šè¿‡
- è¦†ç›–ç‡æŠ¥å‘Šå¿…é¡»è¾¾åˆ°æ ‡å‡†
- å¤±è´¥çš„æµ‹è¯•å¿…é¡»ä¿®å¤

---

**åˆ¶å®šè€…**: å·¥ç¨‹å¸ˆ C (å¹³å°ä¸æ„å»ºä¸“å®¶)  
**åˆ¶å®šæ—¶é—´**: $(date)  
**ç‰ˆæœ¬**: 1.0
