# Normalize Service Environment Variables

## Required Variables

- `DATABASE_URL`: PostgreSQL connection string for the normalize database
  - Example: `postgresql://athlete:athlete@localhost:55432/athlete_normalize`

- `NATS_URL`: NATS server connection string
  - Example: `nats://localhost:4223`

## Optional Variables

- `PORT`: HTTP server port (default: 4112)
- `NORMALIZE_HRV_DURABLE`: HRV consumer durable name (default: normalize-hrv-durable)
- `NORMALIZE_HRV_ACK_WAIT_MS`: ACK wait timeout in milliseconds (default: 60000)
- `NORMALIZE_HRV_MAX_DELIVER`: Maximum delivery attempts (default: 5)
- `NORMALIZE_HRV_DLQ_SUBJECT`: DLQ subject prefix (default: dlq.normalize.hrv.raw-received)

## Stream Migration

The service supports multi-stream mode with fallback:
1. Primary: `AA_CORE_HOT` (future migration target)
2. Fallback: `ATHLETE_ALLY_EVENTS` (current)

Set `EVENT_STREAM_MODE=single` to disable multi-stream fallback.


