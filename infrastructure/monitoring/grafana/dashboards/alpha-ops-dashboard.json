{
  "id": null,
  "uid": "alpha-ops",
  "title": "Alpha Ops Dashboard",
  "tags": ["alpha", "ops", "magic-slice"],
  "timezone": "browser",
  "schemaVersion": 38,
  "version": 1,
  "refresh": "30s",
  "time": { "from": "now-6h", "to": "now" },
  "templating": {
    "list": [
      {
        "name": "job",
        "type": "query",
        "datasource": "Prometheus",
        "query": "label_values(up, job)",
        "refresh": 2,
        "includeAll": true,
        "multi": true,
        "current": { "text": "All", "value": "$__all" }
      }
    ]
  },
  "panels": [
    {
      "type": "stat",
      "title": "Targets Up",
      "gridPos": { "x": 0, "y": 0, "w": 6, "h": 4 },
      "datasource": "Prometheus",
      "targets": [
        { "expr": "sum(up{job=~\"$job\"})", "legendFormat": "up" }
      ]
    },
    {
      "type": "graph",
      "title": "API Errors Rate (BFF)",
      "gridPos": { "x": 6, "y": 0, "w": 9, "h": 8 },
      "datasource": "Prometheus",
      "targets": [
        { "expr": "sum(rate(api_errors_total[5m])) by (job)", "legendFormat": "{{job}}" }
      ]
    },
    {
      "type": "graph",
      "title": "Plan Generation Requests Rate",
      "gridPos": { "x": 15, "y": 0, "w": 9, "h": 8 },
      "datasource": "Prometheus",
      "targets": [
        { "expr": "sum(rate(plan_generation_requests_total[5m])) by (job)", "legendFormat": "{{job}}" }
      ]
    },
    {
      "type": "graph",
      "title": "Plan Generation Duration p95",
      "gridPos": { "x": 0, "y": 8, "w": 12, "h": 8 },
      "datasource": "Prometheus",
      "targets": [
        { "expr": "histogram_quantile(0.95, sum(rate(plan_generation_duration_seconds_bucket[5m])) by (le))", "legendFormat": "p95" }
      ]
    },
    {
      "type": "graph",
      "title": "Planning Engine Event Processing p95",
      "gridPos": { "x": 12, "y": 8, "w": 12, "h": 8 },
      "datasource": "Prometheus",
      "targets": [
        { "expr": "histogram_quantile(0.95, sum(rate(planning_engine_event_processing_duration_seconds_bucket[5m])) by (le))", "legendFormat": "p95" }
      ]
    },
    {
      "type": "graph",
      "title": "Event Bus Published (rate by topic)",
      "gridPos": { "x": 0, "y": 16, "w": 12, "h": 8 },
      "datasource": "Prometheus",
      "targets": [
        { "expr": "sum(rate(event_bus_events_published_total[5m])) by (topic)", "legendFormat": "{{topic}}" }
      ]
    },
    {
      "type": "graph",
      "title": "Event Bus Consumed (rate by topic)",
      "gridPos": { "x": 12, "y": 16, "w": 12, "h": 8 },
      "datasource": "Prometheus",
      "targets": [
        { "expr": "sum(rate(event_bus_events_consumed_total[5m])) by (topic)", "legendFormat": "{{topic}}" }
      ]
    },
    {
      "type": "stat",
      "title": "Concurrent Processing (Planning Engine)",
      "gridPos": { "x": 0, "y": 24, "w": 6, "h": 4 },
      "datasource": "Prometheus",
      "targets": [
        { "expr": "sum(planning_engine_concurrent_processing)", "legendFormat": "concurrent" }
      ]
    }
  ]
}

