# The Ally Workflow - å·¥ç¨‹å®ªæ³•

**ç‰ˆæœ¬**: 1.0  
**æœ€åæ›´æ–°**: 2025-01-27  
**é€‚ç”¨èŒƒå›´**: Athlete Ally é¡¹ç›®å…¨ä½“å¼€å‘å›¢é˜Ÿ

---

## ğŸ¯ å·¥ä½œæµæ¦‚è¿°

The Ally Workflow æ˜¯æˆ‘ä»¬å›¢é˜Ÿçš„æ ¸å¿ƒå¼€å‘æ ‡å‡†ï¼Œç¡®ä¿ä»åŠŸèƒ½æ„æ€åˆ°ç”Ÿäº§éƒ¨ç½²çš„æ¯ä¸€ä¸ªç¯èŠ‚éƒ½ç»è¿‡ç§‘å­¦åŒ–ã€æ ‡å‡†åŒ–çš„å¤„ç†ã€‚æœ¬å·¥ä½œæµåŸºäº"åˆåŒä¼˜å…ˆ"å’Œ"æµ‹è¯•é©±åŠ¨"çš„å¼€å‘ç†å¿µï¼Œç»“åˆè‡ªåŠ¨åŒ–CI/CDå’Œé¢„è§ˆç¯å¢ƒï¼Œå®ç°é«˜è´¨é‡ã€é«˜æ•ˆç‡çš„è½¯ä»¶å¼€å‘ã€‚

### æ ¸å¿ƒåŸåˆ™
- **åˆåŒä¼˜å…ˆ**: APIå¥‘çº¦å…ˆè¡Œï¼Œç¡®ä¿å‰åç«¯è§£è€¦
- **æµ‹è¯•é©±åŠ¨**: æµ‹è¯•å…ˆè¡Œï¼Œä¿è¯ä»£ç è´¨é‡
- **è‡ªåŠ¨åŒ–ä¼˜å…ˆ**: æœ€å¤§åŒ–åˆ©ç”¨CI/CDï¼Œå‡å°‘æ‰‹åŠ¨æ“ä½œ
- **é¢„è§ˆç¯å¢ƒ**: æ¯ä¸ªPRéƒ½æœ‰ç‹¬ç«‹çš„æµ‹è¯•ç¯å¢ƒ

---

## ğŸ“‹ å››ä¸ªæ ¸å¿ƒé˜¶æ®µ

### 1ï¸âƒ£ å‡†å¤‡é˜¶æ®µ (Preparation Phase)
**ç›®æ ‡**: ä»PRDåˆ°æŠ€æœ¯è¯„å®¡çš„å®Œæ•´å‡†å¤‡

### 2ï¸âƒ£ å¼€å‘é˜¶æ®µ (Development Phase)  
**ç›®æ ‡**: åˆåŒä¼˜å…ˆå’Œæµ‹è¯•é©±åŠ¨çš„å¼€å‘æµç¨‹

### 3ï¸âƒ£ å®¡æŸ¥é˜¶æ®µ (Review Phase)
**ç›®æ ‡**: è‡ªåŠ¨åŒ–CI/CDå’Œé¢„è§ˆç¯å¢ƒéªŒè¯

### 4ï¸âƒ£ å‘å¸ƒé˜¶æ®µ (Release Phase)
**ç›®æ ‡**: ç”Ÿäº§éƒ¨ç½²å’Œç›‘æ§éªŒè¯

---

## 1ï¸âƒ£ å‡†å¤‡é˜¶æ®µ (Preparation Phase)

### 1.1 éœ€æ±‚åˆ†æ
**è¾“å…¥**: PRDæ–‡æ¡£ã€ç”¨æˆ·æ•…äº‹  
**è¾“å‡º**: æŠ€æœ¯éœ€æ±‚æ–‡æ¡£

#### 1.1.1 PRDå®¡æŸ¥
- [ ] ç¡®è®¤ç”¨æˆ·æ•…äº‹å®Œæ•´æ€§
- [ ] éªŒè¯ä¸šåŠ¡é€»è¾‘æ¸…æ™°åº¦
- [ ] è¯†åˆ«æŠ€æœ¯è¾¹ç•Œå’Œçº¦æŸ
- [ ] è¯„ä¼°å¼€å‘å¤æ‚åº¦

#### 1.1.2 æŠ€æœ¯éœ€æ±‚å®šä¹‰
- [ ] ç¡®å®šAPIæ¥å£éœ€æ±‚
- [ ] å®šä¹‰æ•°æ®æ¨¡å‹å˜æ›´
- [ ] è¯†åˆ«å¤–éƒ¨ä¾èµ–
- [ ] è¯„ä¼°æ€§èƒ½è¦æ±‚

### 1.2 æ¶æ„è®¾è®¡
**è¾“å…¥**: æŠ€æœ¯éœ€æ±‚æ–‡æ¡£  
**è¾“å‡º**: æŠ€æœ¯è®¾è®¡æ–‡æ¡£

#### 1.2.1 ç³»ç»Ÿè®¾è®¡
- [ ] ç»˜åˆ¶ç³»ç»Ÿæ¶æ„å›¾
- [ ] å®šä¹‰æœåŠ¡è¾¹ç•Œ
- [ ] è®¾è®¡æ•°æ®æµ
- [ ] ç¡®å®šæŠ€æœ¯æ ˆé€‰æ‹©

#### 1.2.2 APIè®¾è®¡
- [ ] è®¾è®¡REST APIæ¥å£
- [ ] å®šä¹‰è¯·æ±‚/å“åº”æ ¼å¼
- [ ] åˆ›å»ºOpenAPIè§„èŒƒ
- [ ] è®¾è®¡é”™è¯¯å¤„ç†æœºåˆ¶

### 1.3 åˆåŒå®šä¹‰
**è¾“å…¥**: APIè®¾è®¡  
**è¾“å‡º**: æœåŠ¡åˆåŒ

#### 1.3.1 å‰ç«¯-åç«¯åˆåŒ
- [ ] å®šä¹‰Gateway BFFæ¥å£
- [ ] åˆ›å»ºTypeScriptç±»å‹å®šä¹‰
- [ ] ç”ŸæˆMockæ•°æ®
- [ ] éªŒè¯åˆåŒå®Œæ•´æ€§

#### 1.3.2 å¾®æœåŠ¡é—´åˆåŒ
- [ ] å®šä¹‰gRPC/HTTPæ¥å£
- [ ] åˆ›å»ºProtoæ–‡ä»¶
- [ ] å®šä¹‰äº‹ä»¶å¥‘çº¦
- [ ] å»ºç«‹æœåŠ¡å‘ç°æœºåˆ¶

### 1.4 æŠ€æœ¯è¯„å®¡
**è¾“å…¥**: æŠ€æœ¯è®¾è®¡æ–‡æ¡£ã€æœåŠ¡åˆåŒ  
**è¾“å‡º**: è¯„å®¡é€šè¿‡ç¡®è®¤

#### 1.4.1 è®¾è®¡è¯„å®¡
- [ ] æ¶æ„åˆç†æ€§å®¡æŸ¥
- [ ] æ€§èƒ½å½±å“è¯„ä¼°
- [ ] å®‰å…¨æ€§æ£€æŸ¥
- [ ] å¯ç»´æŠ¤æ€§è¯„ä¼°

#### 1.4.2 åˆåŒè¯„å®¡
- [ ] APIè®¾è®¡åˆç†æ€§
- [ ] ç±»å‹å®šä¹‰å®Œæ•´æ€§
- [ ] å‘åå…¼å®¹æ€§æ£€æŸ¥
- [ ] é”™è¯¯å¤„ç†å®Œæ•´æ€§

---

## 2ï¸âƒ£ å¼€å‘é˜¶æ®µ (Development Phase)

### 2.1 ç¯å¢ƒå‡†å¤‡
**è¾“å…¥**: æŠ€æœ¯è¯„å®¡é€šè¿‡ç¡®è®¤  
**è¾“å‡º**: å¼€å‘ç¯å¢ƒå°±ç»ª

#### 2.1.1 åˆ†æ”¯ç­–ç•¥
- [ ] ä»`develop`åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
- [ ] åˆ†æ”¯å‘½å: `feature/US-XXX-description`
- [ ] è®¾ç½®åˆ†æ”¯ä¿æŠ¤è§„åˆ™
- [ ] é…ç½®CI/CDè§¦å‘

#### 2.1.2 å¼€å‘ç¯å¢ƒ
- [ ] å¯åŠ¨æœ¬åœ°å¼€å‘ç¯å¢ƒ: `npm run preview:up`
- [ ] éªŒè¯æ‰€æœ‰æœåŠ¡æ­£å¸¸è¿è¡Œ
- [ ] ç¡®è®¤æ•°æ®åº“è¿æ¥
- [ ] æµ‹è¯•åŸºç¡€åŠŸèƒ½

### 2.2 åˆåŒå®ç°
**è¾“å…¥**: æœåŠ¡åˆåŒ  
**è¾“å‡º**: åˆåŒå®ç°å®Œæˆ

#### 2.2.1 åç«¯åˆåŒå®ç°
- [ ] å®ç°APIæ¥å£
- [ ] æ·»åŠ è¾“å…¥éªŒè¯
- [ ] å®ç°é”™è¯¯å¤„ç†
- [ ] æ·»åŠ APIæ–‡æ¡£

#### 2.2.2 å‰ç«¯åˆåŒå®ç°
- [ ] å®ç°APIå®¢æˆ·ç«¯
- [ ] æ·»åŠ ç±»å‹å®šä¹‰
- [ ] å®ç°é”™è¯¯å¤„ç†
- [ ] æ·»åŠ åŠ è½½çŠ¶æ€

### 2.3 æµ‹è¯•é©±åŠ¨å¼€å‘
**è¾“å…¥**: åˆåŒå®ç°  
**è¾“å‡º**: æµ‹è¯•è¦†ç›–çš„ä»£ç 

#### 2.3.1 å•å…ƒæµ‹è¯•
- [ ] ç¼–å†™æœåŠ¡å±‚æµ‹è¯•
- [ ] ç¼–å†™ç»„ä»¶æµ‹è¯•
- [ ] ç¼–å†™å·¥å…·å‡½æ•°æµ‹è¯•
- [ ] ç¡®ä¿æµ‹è¯•è¦†ç›–ç‡ > 80%

**æµ‹è¯•å·¥å…·ä½¿ç”¨**:
- ä½¿ç”¨ `@contracts-test-utils/helpers` ä¸­çš„æ³›å‹æµ‹è¯•å·¥å…·
- ä½¿ç”¨ `@contracts-test-utils/types` ä¸­çš„ç±»å‹å®šä¹‰
- ç¤ºä¾‹: `import { simulateApiCall } from '@contracts-test-utils/helpers'`

#### 2.3.2 é›†æˆæµ‹è¯•
- [ ] ç¼–å†™APIé›†æˆæµ‹è¯•
- [ ] ç¼–å†™æ•°æ®åº“é›†æˆæµ‹è¯•
- [ ] ç¼–å†™æœåŠ¡é—´é€šä¿¡æµ‹è¯•
- [ ] éªŒè¯ç«¯åˆ°ç«¯æµç¨‹

#### 2.3.3 æµ‹è¯•æ‰§è¡Œ
- [ ] æœ¬åœ°è¿è¡Œæµ‹è¯•: `npm run test:all`
- [ ] ä¿®å¤å¤±è´¥çš„æµ‹è¯•
- [ ] éªŒè¯æµ‹è¯•è¦†ç›–ç‡
- [ ] ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡

### 2.4 ä»£ç å®ç°
**è¾“å…¥**: æµ‹è¯•ç”¨ä¾‹  
**è¾“å‡º**: åŠŸèƒ½å®Œæ•´çš„ä»£ç 

#### 2.4.1 ä¸šåŠ¡é€»è¾‘å®ç°
- [ ] å®ç°æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
- [ ] æ·»åŠ æ•°æ®éªŒè¯
- [ ] å®ç°é”™è¯¯å¤„ç†
- [ ] æ·»åŠ æ—¥å¿—è®°å½•

#### 2.4.2 ç”¨æˆ·ç•Œé¢å®ç°
- [ ] å®ç°Reactç»„ä»¶
- [ ] æ·»åŠ æ ·å¼å’Œäº¤äº’
- [ ] å®ç°å“åº”å¼è®¾è®¡
- [ ] æ·»åŠ æ— éšœç¢æ”¯æŒ

### 2.5 ä»£ç è´¨é‡æ£€æŸ¥
**è¾“å…¥**: åŠŸèƒ½ä»£ç   
**è¾“å‡º**: è´¨é‡æ£€æŸ¥é€šè¿‡

#### 2.5.1 é™æ€åˆ†æ
- [ ] è¿è¡ŒESLint: `npm run lint`
- [ ] è¿è¡ŒTypeScriptæ£€æŸ¥: `npm run type-check`
- [ ] ä¿®å¤ä»£ç é£æ ¼é—®é¢˜
- [ ] ç¡®ä¿æ— TypeScripté”™è¯¯

#### 2.5.2 ä»£ç å®¡æŸ¥
- [ ] è‡ªæˆ‘ä»£ç å®¡æŸ¥
- [ ] æ£€æŸ¥ä»£ç é‡å¤
- [ ] éªŒè¯å‘½åè§„èŒƒ
- [ ] ç¡®ä¿æ³¨é‡Šå®Œæ•´æ€§

---

## 3ï¸âƒ£ å®¡æŸ¥é˜¶æ®µ (Review Phase)

### 3.1 è‡ªåŠ¨åŒ–CI/CD
**è¾“å…¥**: ä»£ç æäº¤  
**è¾“å‡º**: CI/CDç®¡é“é€šè¿‡

#### 3.1.1 ä»£ç è´¨é‡æ£€æŸ¥
- [ ] è‡ªåŠ¨è¿è¡ŒESLintæ£€æŸ¥
- [ ] è‡ªåŠ¨è¿è¡ŒTypeScriptæ£€æŸ¥
- [ ] è‡ªåŠ¨è¿è¡Œå•å…ƒæµ‹è¯•
- [ ] è‡ªåŠ¨è¿è¡Œå®‰å…¨æ‰«æ

#### 3.1.2 æ„å»ºéªŒè¯
- [ ] è‡ªåŠ¨æ„å»ºæ‰€æœ‰æœåŠ¡
- [ ] éªŒè¯Dockeré•œåƒæ„å»º
- [ ] æ£€æŸ¥æ„å»ºäº§ç‰©å®Œæ•´æ€§
- [ ] éªŒè¯ç¯å¢ƒå˜é‡é…ç½®

### 3.2 é¢„è§ˆç¯å¢ƒéƒ¨ç½²
**è¾“å…¥**: æ„å»ºæˆåŠŸ  
**è¾“å‡º**: é¢„è§ˆç¯å¢ƒå°±ç»ª

#### 3.2.1 ç¯å¢ƒéƒ¨ç½²
- [ ] è‡ªåŠ¨éƒ¨ç½²åˆ°é¢„è§ˆç¯å¢ƒ
- [ ] å¯åŠ¨æ‰€æœ‰å¾®æœåŠ¡
- [ ] éªŒè¯æœåŠ¡å¥åº·çŠ¶æ€
- [ ] é…ç½®ç›‘æ§å’Œæ—¥å¿—

#### 3.2.2 ç¯å¢ƒéªŒè¯
- [ ] éªŒè¯å‰ç«¯è®¿é—®æ­£å¸¸
- [ ] éªŒè¯APIæ¥å£å¯ç”¨
- [ ] éªŒè¯æ•°æ®åº“è¿æ¥
- [ ] éªŒè¯æœåŠ¡é—´é€šä¿¡

### 3.3 é›†æˆæµ‹è¯•
**è¾“å…¥**: é¢„è§ˆç¯å¢ƒå°±ç»ª  
**è¾“å‡º**: é›†æˆæµ‹è¯•é€šè¿‡

#### 3.3.1 è‡ªåŠ¨åŒ–æµ‹è¯•
- [ ] è¿è¡Œç«¯åˆ°ç«¯æµ‹è¯•
- [ ] è¿è¡Œæ€§èƒ½æµ‹è¯•
- [ ] è¿è¡Œå®‰å…¨æµ‹è¯•
- [ ] éªŒè¯APIåˆåŒ

#### 3.3.2 æ‰‹åŠ¨æµ‹è¯•
- [ ] åŠŸèƒ½å®Œæ•´æ€§æµ‹è¯•
- [ ] ç”¨æˆ·ä½“éªŒæµ‹è¯•
- [ ] è¾¹ç•Œæ¡ä»¶æµ‹è¯•
- [ ] é”™è¯¯åœºæ™¯æµ‹è¯•

### 3.4 ä»£ç å®¡æŸ¥
**è¾“å…¥**: æµ‹è¯•é€šè¿‡  
**è¾“å‡º**: ä»£ç å®¡æŸ¥é€šè¿‡

#### 3.4.1 åŒè¡Œè¯„å®¡
- [ ] è‡³å°‘ä¸€ååŒäº‹å®¡æŸ¥
- [ ] æ£€æŸ¥ä»£ç é€»è¾‘æ­£ç¡®æ€§
- [ ] éªŒè¯æµ‹è¯•è¦†ç›–åº¦
- [ ] ç¡®è®¤æ–‡æ¡£å®Œæ•´æ€§

#### 3.4.2 æ¶æ„å®¡æŸ¥
- [ ] æ£€æŸ¥æ¶æ„ä¸€è‡´æ€§
- [ ] éªŒè¯æ€§èƒ½å½±å“
- [ ] ç¡®è®¤å®‰å…¨æ€§
- [ ] è¯„ä¼°å¯ç»´æŠ¤æ€§

---

## 4ï¸âƒ£ å‘å¸ƒé˜¶æ®µ (Release Phase)

### 4.1 å‘å¸ƒå‡†å¤‡
**è¾“å…¥**: ä»£ç å®¡æŸ¥é€šè¿‡  
**è¾“å‡º**: å‘å¸ƒå°±ç»ª

#### 4.1.1 ç‰ˆæœ¬ç®¡ç†
- [ ] æ›´æ–°ç‰ˆæœ¬å·
- [ ] æ›´æ–°CHANGELOG
- [ ] åˆ›å»ºå‘å¸ƒæ ‡ç­¾
- [ ] å‡†å¤‡å‘å¸ƒè¯´æ˜

#### 4.1.2 ç¯å¢ƒé…ç½®
- [ ] é…ç½®ç”Ÿäº§ç¯å¢ƒå˜é‡
- [ ] éªŒè¯æ•°æ®åº“è¿ç§»
- [ ] æ£€æŸ¥å¤–éƒ¨æœåŠ¡é…ç½®
- [ ] å‡†å¤‡å›æ»šè®¡åˆ’

### 4.2 ç”Ÿäº§éƒ¨ç½²
**è¾“å…¥**: å‘å¸ƒå°±ç»ª  
**è¾“å‡º**: ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å®Œæˆ

#### 4.2.1 éƒ¨ç½²æ‰§è¡Œ
- [ ] æ‰§è¡Œç”Ÿäº§éƒ¨ç½²
- [ ] éªŒè¯æœåŠ¡å¯åŠ¨
- [ ] æ£€æŸ¥å¥åº·çŠ¶æ€
- [ ] éªŒè¯åŠŸèƒ½æ­£å¸¸

#### 4.2.2 éƒ¨ç½²éªŒè¯
- [ ] è¿è¡Œå†’çƒŸæµ‹è¯•
- [ ] éªŒè¯å…³é”®åŠŸèƒ½
- [ ] æ£€æŸ¥æ€§èƒ½æŒ‡æ ‡
- [ ] ç¡®è®¤ç›‘æ§æ­£å¸¸

### 4.3 ç›‘æ§å’ŒéªŒè¯
**è¾“å…¥**: éƒ¨ç½²å®Œæˆ  
**è¾“å‡º**: ç”Ÿäº§ç¯å¢ƒç¨³å®š

#### 4.3.1 å®æ—¶ç›‘æ§
- [ ] ç›‘æ§æœåŠ¡çŠ¶æ€
- [ ] æ£€æŸ¥é”™è¯¯æ—¥å¿—
- [ ] éªŒè¯æ€§èƒ½æŒ‡æ ‡
- [ ] ç›‘æ§ç”¨æˆ·åé¦ˆ

#### 4.3.2 é—®é¢˜å¤„ç†
- [ ] å¿«é€Ÿå“åº”é—®é¢˜
- [ ] æ‰§è¡Œå›æ»šï¼ˆå¦‚éœ€è¦ï¼‰
- [ ] è®°å½•é—®é¢˜åŸå› 
- [ ] åˆ¶å®šæ”¹è¿›è®¡åˆ’

---

## ğŸ› ï¸ å¼€å‘å·¥å…·å’Œè„šæœ¬

### æœ¬åœ°å¼€å‘ç¯å¢ƒ
```bash
# å¯åŠ¨å®Œæ•´å¼€å‘ç¯å¢ƒ
npm run preview:up

# åœæ­¢å¼€å‘ç¯å¢ƒ
npm run preview:down

# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm run test:all

# è¿è¡Œç«¯åˆ°ç«¯æµ‹è¯•
npm run test:e2e

# æ„å»ºæ‰€æœ‰æœåŠ¡
npm run build:all
```

### ä»£ç è´¨é‡å·¥å…·
```bash
# ä»£ç æ£€æŸ¥
npm run lint

# ç±»å‹æ£€æŸ¥
npm run type-check

# å®‰å…¨å®¡è®¡
npm audit
```

### æ•°æ®åº“ç®¡ç†
```bash
# ç”ŸæˆPrismaå®¢æˆ·ç«¯
npx turbo run db:generate

# è¿è¡Œæ•°æ®åº“è¿ç§»
npx turbo run db:migrate
```

---

## ğŸ“Š è´¨é‡æŒ‡æ ‡

### ä»£ç è´¨é‡
- **æµ‹è¯•è¦†ç›–ç‡**: > 80%
- **TypeScripté”™è¯¯**: 0
- **ESLintè­¦å‘Š**: < 5
- **ä»£ç é‡å¤ç‡**: < 5%

### æ€§èƒ½æŒ‡æ ‡
- **é¡µé¢åŠ è½½æ—¶é—´**: < 2ç§’
- **APIå“åº”æ—¶é—´**: < 500ms
- **æ•°æ®åº“æŸ¥è¯¢æ—¶é—´**: < 100ms
- **å†…å­˜ä½¿ç”¨**: < 512MB

### å®‰å…¨æŒ‡æ ‡
- **å®‰å…¨æ¼æ´**: 0 (é«˜å±)
- **ä¾èµ–æ¼æ´**: 0 (é«˜å±)
- **æ•æ„Ÿä¿¡æ¯æ³„éœ²**: 0
- **è®¤è¯å¤±è´¥ç‡**: < 1%

---

## ğŸš¨ åº”æ€¥å¤„ç†

### ç”Ÿäº§é—®é¢˜
1. **ç«‹å³å“åº”**: 5åˆ†é’Ÿå†…å“åº”
2. **é—®é¢˜è¯Šæ–­**: 15åˆ†é’Ÿå†…å®šä½
3. **ä¸´æ—¶ä¿®å¤**: 30åˆ†é’Ÿå†…å®æ–½
4. **æ ¹æœ¬ä¿®å¤**: 24å°æ—¶å†…å®Œæˆ

### å›æ»šç­–ç•¥
1. **è‡ªåŠ¨å›æ»š**: å…³é”®æŒ‡æ ‡å¼‚å¸¸æ—¶è‡ªåŠ¨è§¦å‘
2. **æ‰‹åŠ¨å›æ»š**: é€šè¿‡CI/CDç®¡é“æ‰§è¡Œ
3. **æ•°æ®å›æ»š**: æ•°æ®åº“çŠ¶æ€å›æ»š
4. **æœåŠ¡å›æ»š**: æœåŠ¡ç‰ˆæœ¬å›æ»š

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [é¡¹ç›®æ¶æ„æ–‡æ¡£](./docs/v3-architecture-design.md)
- [APIæ–‡æ¡£](./API_ENDPOINTS_OVERVIEW.md)
- [éƒ¨ç½²æŒ‡å—](./README.md)
- [æµ‹è¯•æŒ‡å—](./tests/README.md)

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

### æäº¤ä»£ç 
1. éµå¾ªæœ¬å·¥ä½œæµçš„æ‰€æœ‰é˜¶æ®µ
2. ç¡®ä¿æ‰€æœ‰æ£€æŸ¥é€šè¿‡
3. æä¾›æ¸…æ™°çš„æäº¤ä¿¡æ¯
4. å…³è”ç›¸å…³Issue

### é—®é¢˜æŠ¥å‘Š
1. ä½¿ç”¨æ ‡å‡†æ¨¡æ¿
2. æä¾›å¤ç°æ­¥éª¤
3. åŒ…å«ç¯å¢ƒä¿¡æ¯
4. æ·»åŠ ç›¸å…³æ—¥å¿—

### åŠŸèƒ½è¯·æ±‚
1. å…ˆåˆ›å»ºIssueè®¨è®º
2. æä¾›è¯¦ç»†éœ€æ±‚æè¿°
3. è€ƒè™‘æŠ€æœ¯å¯è¡Œæ€§
4. è¯„ä¼°å½±å“èŒƒå›´

---

**è®°ä½**: The Ally Workflow æ˜¯æˆ‘ä»¬å›¢é˜Ÿçš„è´¨é‡ä¿è¯ï¼Œæ¯ä¸€ä¸ªæ­¥éª¤éƒ½æ˜¯ä¸ºäº†ç¡®ä¿æˆ‘ä»¬äº¤ä»˜çš„ä»£ç æ˜¯é«˜è´¨é‡ã€å¯ç»´æŠ¤ã€å¯æ‰©å±•çš„ã€‚éµå¾ªè¿™ä¸ªå·¥ä½œæµï¼Œæˆ‘ä»¬å°±èƒ½æŒç»­äº¤ä»˜ä»·å€¼ï¼ŒåŒæ—¶ä¿æŒä»£ç åº“çš„å¥åº·çŠ¶æ€ã€‚

## æµ‹è¯•è§„èŒƒï¼ˆç»Ÿä¸€çº¦å®šï¼‰

- ä¼˜å…ˆä½¿ç”¨â€œæ³›å‹ helpersâ€ä¸ç»Ÿä¸€ç»“æœå½¢çŠ¶
  - ç»Ÿä¸€ç»“æœï¼š`type ApiResponse<T> = { ok: true; data: T } | { ok: false; error: unknown }`
  - å·¥å…·ï¼š`ok/err/fromPromise/isOk/unwrap/map`ï¼ˆè§å„åŒ… `packages/<pkg>/tests/test-utils`ï¼Œæˆ–åˆ«å `@<pkg>-test-utils/*`ï¼‰
  - åœ¨æµ‹è¯•ä¸­å…ˆåˆ¤æ–­ `ok` å†è®¿é—® `data`ï¼Œå¤±è´¥åˆ†æ”¯æ–­è¨€ `error`
- è¿è¡Œæ—¶æ ¡éªŒï¼šå…³é”® I/O è¾¹ç•Œä½¿ç”¨ zod è§£ææ–­è¨€
  - å…±äº« Schema ä½äº `packages/shared-types/src/schemas/*`
  - æ–­è¨€ç¤ºä¾‹ï¼š`const parsed = Schema.safeParse(json); expect(parsed.success).toBe(true)`
  - ä»…åœ¨å¿…è¦æ—¶åšè§£ææ–­è¨€ï¼›å†…éƒ¨çº¯è®¡ç®—å¯åªç”¨ TS ç±»å‹
- æ¨¡æ‹Ÿå·¥å…·ï¼šä¼˜å…ˆå¤ç”¨å·²æœ‰ helpers è€Œéé‡å¤é€ è½®å­
  - `simulateApiCall/simulateServiceFailure/simulateRetryOperation` ç­‰ä½äº `packages/contracts/tests/test-utils`
  - è¿›é˜¶ï¼šå¿…è¦æ—¶æ–°å¢é€šç”¨ helperï¼Œæ”¾åˆ°å¯¹åº”åŒ…çš„ `tests/test-utils`
- æ–­è¨€ä¸è¦â€œæ”¶çª„/è„†å¼±â€ï¼ˆDo not overâ€‘specifyï¼‰
  - é¿å…å¯¹å®Œæ•´å¯¹è±¡åš `deepEqual` æˆ–ä¸¥æ ¼å­—æ®µæšä¸¾ï¼›ä¼˜å…ˆæ–­è¨€å½¢çŠ¶/å¿…è¦å­—æ®µ/å…³é”®çº¦æŸ
  - ç¤ºä¾‹ï¼š`expect(arr).toHaveLength(>=1)`ã€`expect(item).toHaveProperty('id')`ã€`expect(value).toBeGreaterThan(0)`
- ç±»å‹ä¸å®‰å…¨ï¼š
  - æµ‹è¯•é»˜è®¤éµå®ˆ `@typescript-eslint/no-unsafe-*` è§„åˆ™ï¼ˆå¿…è¦å¤„å¯å±€éƒ¨ disable å¹¶å†™æ˜åŸå› ï¼‰
  - é¿å… `any`ï¼›ä½¿ç”¨ z.infer åŒæ­¥ç±»å‹ï¼š`type T = z.infer<typeof Schema>`
- å—å½±å“æµ‹è¯•ä¸æœ¬åœ°æ ¡éªŒï¼š
  - ä»…è·‘å—å½±å“ç”¨ä¾‹ï¼š`jest -o` æˆ– `jest --findRelatedTests`
  - æœ¬åœ°ä¸¥æ ¼æ£€æŸ¥ï¼š`npm run lint:tests:strict`ã€ç±»å‹è¦†ç›–ç‡ï¼š`npm run type:coverage:*`
  - é¢„æäº¤å·²å¯ç”¨ Husky + lint-stagedï¼šè‡ªåŠ¨æ‰§è¡Œ eslint ä¿®å¤ã€å—å½±å“æµ‹è¯•ã€å˜æ›´èŒƒå›´ type-check
